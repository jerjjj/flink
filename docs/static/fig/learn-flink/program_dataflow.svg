<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" id="svg2" width="632.862" height="495.709" version="1.1"><metadata id="metadata7"/><g id="g2989" transform="translate(-24.15625,-20.40625)" style="opacity:1;stop-opacity:1"><text id="text2991" x="571.352" y="45.804" xml:space="preserve" style="font-style:italic;font-weight:400;font-size:11.2528px;font-family:Verdana;text-align:start;text-anchor:start;fill:#000">Source</text><text id="text2993" x="25.305" y="37.766" xml:space="preserve" style="font-style:normal;font-weight:700;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#843c0c">DataStream</text><text id="text2995" x="107.975" y="37.766" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">&lt;</text><text id="text2997" x="116.227" y="37.766" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#5b9bd5">String</text><text id="text2999" x="166.04" y="37.766" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">&gt;</text><text id="text3001" x="182.694" y="37.766" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">lines =</text><text id="text3003" x="248.86" y="37.766" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">env.</text><text id="text3005" x="282.018" y="37.766" xml:space="preserve" style="font-style:normal;font-weight:700;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#843c0c">addSource</text><text id="text3007" x="356.587" y="37.766" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">(</text><text id="text3009" x="282.018" y="54.27" xml:space="preserve" style="font-style:normal;font-weight:700;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#2f5597">new</text><text id="text3011" x="315.177" y="54.27" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">FlinkKafkaConsumer</text><text id="text3013" x="464.314" y="54.27" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">&lt;&gt;(â€¦));</text><text id="text3015" x="25.305" y="87.278" xml:space="preserve" style="font-style:normal;font-weight:700;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#843c0c">DataStream</text><text id="text3017" x="107.975" y="87.278" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">&lt;</text><text id="text3019" x="116.227" y="87.278" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#5b9bd5">Event</text><text id="text3021" x="157.788" y="87.278" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">&gt; events =</text><text id="text3023" x="248.86" y="87.278" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">lines.</text><text id="text3025" x="298.523" y="87.278" xml:space="preserve" style="font-style:normal;font-weight:700;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#843c0c">map</text><text id="text3027" x="323.579" y="87.278" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">((line)</text><text id="text3029" x="389.745" y="87.278" xml:space="preserve" style="font-style:normal;font-weight:700;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#2f5597">-</text><text id="text3031" x="397.997" y="87.278" xml:space="preserve" style="font-style:normal;font-weight:700;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#2f5597">&gt;</text><text id="text3033" x="414.501" y="87.278" xml:space="preserve" style="font-style:italic;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">parse</text><text id="text3035" x="456.062" y="87.278" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">(line));</text><text id="text3037" x="25.305" y="120.286" xml:space="preserve" style="font-style:normal;font-weight:700;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#843c0c">DataStream</text><text id="text3039" x="107.975" y="120.286" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">&lt;</text><text id="text3041" x="116.227" y="120.286" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#5b9bd5">Statistics</text><text id="text3043" x="199.198" y="120.286" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">&gt; stats = events</text><text id="text3045" x="91.471" y="136.79" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">.</text><text id="text3047" x="99.723" y="136.79" xml:space="preserve" style="font-style:normal;font-weight:700;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#843c0c">keyBy</text><text id="text3049" x="141.133" y="136.415" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">(</text><text id="text3051" x="149.385" y="136.79" xml:space="preserve" style="font-style:normal;font-weight:700;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#548235"><tspan id="tspan104" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:13.8034px;font-family:'Courier New';-inkscape-font-specification:'Courier New Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;fill:#333">event</tspan><tspan id="tspan106" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:13.8034px;font-family:'Courier New';-inkscape-font-specification:'Courier New Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal"> <tspan id="tspan939" style="fill:#1a1a1a">-&gt; event.id</tspan></tspan></text><text id="text3053" x="290.694" y="136.415" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">)</text><text id="text3055" x="91.471" y="153.294" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">.</text><text id="text3057" x="99.723" y="153.294" xml:space="preserve" style="font-style:normal;font-weight:700;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#843c0c">timeWindow</text><text id="text3059" x="182.694" y="153.294" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">(</text><text id="text3061" x="190.946" y="153.294" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">Time.seconds</text><text id="text3063" x="290.271" y="153.294" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">(10))</text><text id="text3065" x="91.471" y="169.798" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">.</text><text id="text3067" x="99.723" y="169.798" xml:space="preserve" style="font-style:normal;font-weight:700;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#843c0c">apply</text><text id="text3069" x="141.133" y="169.798" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">(</text><text id="text3071" x="149.385" y="169.798" xml:space="preserve" style="font-style:normal;font-weight:700;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#2f5597">new</text><text id="text3073" x="182.694" y="169.798" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">MyWindowAggregationFunction</text><text id="text3075" x="406.249" y="169.798" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">());</text><text id="text3077" x="25.305" y="202.205" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">stats.</text><text id="text3079" x="74.817" y="202.63" xml:space="preserve" style="font-style:normal;font-weight:700;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#843c0c">addSink</text><text id="text3081" x="132.881" y="202.807" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">(</text><text id="text3083" x="141.133" y="202.165" xml:space="preserve" style="font-style:normal;font-weight:700;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#2f5597">new</text><text id="text3085" x="174.442" y="202.196" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">MySink</text><text id="text3087" x="221.166" y="202.054" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:13.8034px;font-family:'Courier New';text-align:start;text-anchor:start;fill:#000">(...));</text><path id="path3089" d="m 32.445583,379.40702 c 0,-17.70441 14.309815,-32.05174 31.957962,-32.05174 17.648146,0 31.957961,14.34733 31.957961,32.05174 0,17.68566 -14.309815,32.03298 -31.957961,32.03298 -17.648147,0 -31.957962,-14.34732 -31.957962,-32.03298" style="fill:#ffd966;fill-opacity:1;fill-rule:evenodd;stroke:none"/><text id="text3091" x="46.974" y="383.35" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:10.0525px;font-family:Verdana;text-align:start;text-anchor:start;fill:#000">Source</text><path id="path3093" d="m 170.44246,379.40702 c 0,-17.70441 14.34733,-32.05174 32.03298,-32.05174 17.70441,0 32.05174,14.34733 32.05174,32.05174 0,17.68566 -14.34733,32.03298 -32.05174,32.03298 -17.68565,0 -32.03298,-14.34732 -32.03298,-32.03298" style="fill:#ffd966;fill-opacity:1;fill-rule:evenodd;stroke:none"/><text id="text3095" x="187.062" y="383.35" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:10.0525px;font-family:Verdana;text-align:start;text-anchor:start;fill:#000">map()</text><path id="path3097" d="m 104.1822,375.18722 h 50.16875 v -4.2198 l 8.43961,8.4396 -8.43961,8.4396 v -4.2198 H 104.1822 Z" style="fill:#bfbfbf;fill-opacity:1;fill-rule:evenodd;stroke:none"/><path id="path3099" d="m 532.55767,21.023988 c 4.93248,0 8.90847,0.675168 8.90847,1.500373 v 17.49811 c 0,0.825205 3.99475,1.481619 8.90847,1.481619 -4.91372,0 -8.90847,0.675168 -8.90847,1.481619 v 17.516864 c 0,0.806451 -3.97599,1.481619 -8.90847,1.481619" style="fill:none;stroke:#000;stroke-width:1.25656px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"/><path id="path3101" d="m 532.55767,70.573832 c 4.93248,0 8.90847,0.675168 8.90847,1.481619 v 9.771184 c 0,0.825206 3.99475,1.481619 8.90847,1.481619 -4.91372,0 -8.90847,0.675168 -8.90847,1.481619 v 9.771185 c 0,0.825205 -3.97599,1.481619 -8.90847,1.481619" style="fill:none;stroke:#000;stroke-width:1.25656px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"/><path id="path3103" d="m 532.08881,104.65107 c 4.93248,0 8.90847,0.65641 8.90847,1.48162 v 33.83343 c 0,0.8252 3.99474,1.48162 8.90847,1.48162 -4.91373,0 -8.90847,0.67517 -8.90847,1.48162 v 33.85218 c 0,0.80645 -3.97599,1.48162 -8.90847,1.48162" style="fill:none;stroke:#000;stroke-width:1.25656px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"/><path id="path3105" d="m 532.08881,188.2594 c 4.93248,0 8.90847,0.67517 8.90847,1.48162 v 9.62115 c 0,0.8252 3.99474,1.48162 8.90847,1.48162 -4.91373,0 -8.90847,0.65641 -8.90847,1.48161 v 9.62115 c 0,0.80645 -3.97599,1.48162 -8.90847,1.48162" style="fill:none;stroke:#000;stroke-width:1.25656px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"/><text id="text3107" x="571.352" y="86.227" xml:space="preserve" style="font-style:italic;font-weight:400;font-size:11.2528px;font-family:Verdana;text-align:start;text-anchor:start;fill:#000">Transformation</text><text id="text3109" x="571.352" y="145.722" xml:space="preserve" style="font-style:italic;font-weight:400;font-size:11.2528px;font-family:Verdana;text-align:start;text-anchor:start;fill:#000">Transformation</text><text id="text3111" x="94.209" y="313.348" xml:space="preserve" style="font-style:italic;font-weight:400;font-size:11.2528px;font-family:Verdana;text-align:start;text-anchor:start;fill:#000">Source</text><text id="text3113" x="88.508" y="326.852" xml:space="preserve" style="font-style:italic;font-weight:400;font-size:11.2528px;font-family:Verdana;text-align:start;text-anchor:start;fill:#000">Operator</text><path id="path3115" d="m 242.17908,375.18722 h 50.16875 v -4.2198 l 8.4396,8.4396 -8.4396,8.4396 v -4.2198 h -50.16875 z" style="fill:#bfbfbf;fill-opacity:1;fill-rule:evenodd;stroke:none"/><path id="path3117" d="m 308.43934,379.40702 c 0,-17.70441 14.34732,-32.05174 32.05173,-32.05174 17.68566,0 32.03299,14.34733 32.03299,32.05174 0,17.68566 -14.34733,32.03298 -32.03299,32.03298 -17.70441,0 -32.05173,-14.34732 -32.05173,-32.03298" style="fill:#ffd966;fill-opacity:1;fill-rule:evenodd;stroke:none"/><text id="text3119" x="318.245" y="371.347" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:10.0525px;font-family:Verdana;text-align:start;text-anchor:start;fill:#000">keyBy</text><text id="text3121" x="349.153" y="371.347" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:10.0525px;font-family:Verdana;text-align:start;text-anchor:start;fill:#000">()/</text><text id="text3123" x="314.794" y="383.35" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:10.0525px;font-family:Verdana;text-align:start;text-anchor:start;fill:#000">window()/</text><text id="text3125" x="322.296" y="395.353" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:10.0525px;font-family:Verdana;text-align:start;text-anchor:start;fill:#000">apply()</text><path id="path3127" d="m 380.17596,375.18722 h 50.16875 v -4.2198 l 8.4396,8.4396 -8.4396,8.4396 v -4.2198 h -50.16875 z" style="fill:#bfbfbf;fill-opacity:1;fill-rule:evenodd;stroke:none"/><path id="path3129" d="m 446.45497,379.40702 c 0,-17.70441 14.34733,-32.05174 32.03298,-32.05174 17.70441,0 32.03298,14.34733 32.03298,32.05174 0,17.68566 -14.32857,32.03298 -32.03298,32.03298 -17.68565,0 -32.03298,-14.34732 -32.03298,-32.03298" style="fill:#ffd966;fill-opacity:1;fill-rule:evenodd;stroke:none"/><text id="text3131" x="467.476" y="383.35" xml:space="preserve" style="font-style:normal;font-weight:400;font-size:10.0525px;font-family:Verdana;text-align:start;text-anchor:start;fill:#000">Sink</text><path id="path3133" d="m 240.45365,250.46865 h 17.01049 v -16.2603 h 33.98347 v 16.2603 h 16.99173 l -33.98347,16.24154 z" style="fill:none;stroke:#000;stroke-width:1.25656px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"/><text id="text3135" x="227.004" y="313.348" xml:space="preserve" style="font-style:italic;font-weight:400;font-size:11.2528px;font-family:Verdana;text-align:start;text-anchor:start;fill:#000">Transformation</text><text id="text3137" x="242.007" y="326.852" xml:space="preserve" style="font-style:italic;font-weight:400;font-size:11.2528px;font-family:Verdana;text-align:start;text-anchor:start;fill:#000">Operators</text><text id="text3139" x="438.992" y="313.348" xml:space="preserve" style="font-style:italic;font-weight:400;font-size:11.2528px;font-family:Verdana;text-align:start;text-anchor:start;fill:#000">Sink</text><text id="text3141" x="426.088" y="326.852" xml:space="preserve" style="font-style:italic;font-weight:400;font-size:11.2528px;font-family:Verdana;text-align:start;text-anchor:start;fill:#000">Operator</text><path id="path3143" d="m 451.65002,333.72064 5.6264,8.21454 -1.03151,0.69393 -5.6264,-8.19579 z m 6.4516,6.11402 0.76895,5.53263 -4.89497,-2.70067 z" style="fill:#000;fill-opacity:1;fill-rule:nonzero;stroke:#000;stroke-width:.0187547px;stroke-linecap:butt;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1"/><path id="path3145" d="m 89.591069,331.58261 -4.688668,8.04575 1.069017,0.63766 4.688668,-8.06451 z m -5.682665,6.02025 -0.356339,5.58889 4.669913,-3.07577 z" style="fill:#000;fill-opacity:1;fill-rule:nonzero;stroke:#000;stroke-width:.0187547px;stroke-linecap:butt;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1"/><path id="path3147" d="m 234.03956,329.40706 -12.92197,12.80944 0.88147,0.88147 12.92196,-12.79068 z m -13.35333,10.59639 -1.80045,5.28882 5.32633,-1.74418 z" style="fill:#000;fill-opacity:1;fill-rule:nonzero;stroke:#000;stroke-width:.0187547px;stroke-linecap:butt;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1"/><path id="path3149" d="m 301.21879,329.40706 15.51012,14.72242 -0.86272,0.90023 -15.51011,-14.72242 z m 15.88521,12.49062 1.91298,5.27006 -5.34509,-1.63166 z" style="fill:#000;fill-opacity:1;fill-rule:nonzero;stroke:#000;stroke-width:.0187547px;stroke-linecap:butt;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1"/><path id="path3151" d="m 241.72897,447.91784 -87.19047,-54.5761 0.65641,-1.06902 87.20923,54.5761 z m -87.13421,-52.32554 -2.90697,-4.78244 5.57014,0.54389 z" style="fill:#000;fill-opacity:1;fill-rule:nonzero;stroke:#000;stroke-width:.0187547px;stroke-linecap:butt;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1"/><text id="text3153" x="245.671" y="463.081" xml:space="preserve" style="font-style:italic;font-weight:400;font-size:11.2528px;font-family:Verdana;text-align:start;text-anchor:start;fill:#000">Stream</text><path id="path3155" d="m 291.37259,447.9741 102.90688,-49.34354 -0.54388,-1.12528 -102.90689,49.34354 z m 102.58806,-47.11174 3.41335,-4.4261 -5.5889,-0.0938 2.17555,4.51987 z" style="fill:#000;fill-opacity:1;fill-rule:nonzero;stroke:#000;stroke-width:.0187547px;stroke-linecap:butt;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1"/><path id="path3157" d="m 270.77996,440.92234 v -39.79741 h -1.25656 v 39.79741 z m 1.87547,-38.54085 -2.49438,-5.00749 -2.51312,5.00749 z" style="fill:#000;fill-opacity:1;fill-rule:nonzero;stroke:#000;stroke-width:.0187547px;stroke-linecap:butt;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1"/><text id="text3159" x="571.352" y="205.128" xml:space="preserve" style="font-style:italic;font-weight:400;font-size:11.2528px;font-family:Verdana;text-align:start;text-anchor:start;fill:#000">Sink</text><path id="path3161" d="m 516.93503,463.33418 c 0,8.15828 -1.10652,14.75993 -2.45686,14.75993 H 273.33059 c -1.36909,0 -2.47561,6.62039 -2.47561,14.77868 0,-8.15829 -1.08777,-14.77868 -2.45687,-14.77868 H 27.250539 c -1.369091,0 -2.475617,-6.60165 -2.475617,-14.75993" style="fill:none;stroke:#000;stroke-width:1.25656px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"/><text id="text3163" x="214.032" y="513.791" xml:space="preserve" style="font-style:italic;font-weight:400;font-size:11.2528px;font-family:Verdana;text-align:start;text-anchor:start;fill:#000">Streaming Dataflow</text></g></svg>